<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NiYien A1 Video Tutorial</title>
  <link rel="icon" href="assets/icon/logo.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#36CFC9',
            accent: '#722ED1',
            neutral: '#F2F3F5',
            'neutral-dark': '#4E5969',
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }

      .video-ratio {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 ratio */
        height: 0;
        overflow: hidden;
      }

      .video-ratio iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* Prevent iframe click events */
      }

      /* Allow clicks on videos in the modal */
      .modal .video-ratio iframe {
        pointer-events: auto;
      }

      .card-hover {
        @apply transition-all duration-300 hover:shadow-lg hover:scale-[1.02] hover:z-10;
      }

      .section-title {
        @apply text-xl font-bold text-gray-800 mb-3 flex items-center cursor-pointer;
      }

      .required-badge {
        @apply bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full ml-2;
      }

      .filter-active {
        @apply bg-primary text-white;
      }

      .first-use-badge {
        @apply bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full;
        transform: scale(0.8);
        transform-origin: center;
      }

      /* Unify video card width - Make it responsive */
      .video-card {
        @apply w-full max-w-md mx-auto; /* Max width is md, auto-adapt on small screens */
      }

      .video-grid-container {
        @apply max-w-7xl mx-auto px-4; /* Add padding to prevent edge overflow */
      }

      /* Responsive font adjustment */
      .header-title {
        @apply text-2xl md:text-[clamp(1.5rem,3vw,2rem)] font-bold text-gray-800;
      }

      .nav-button {
        @apply text-sm md:text-base px-4 md:px-6 py-2 md:py-3;
      }

      /* Adjust download card */
      .download-card {
        @apply bg-white rounded-xl shadow-sm p-6 text-center transition-all duration-300 hover:shadow-lg hover:scale-[1.02];
      }

      .wechat-qrcode {
        @apply bg-white rounded-xl shadow-sm p-6 text-center transition-all duration-300 hover:shadow-lg;
      }

      /* Collapsible panel styles */
      .collapsible-header {
        @apply flex justify-between items-center py-4 px-6 cursor-pointer bg-white border-b border-gray-100 hover:bg-gray-50 transition-colors;
      }

      .collapsible-content {
        @apply max-h-0 overflow-hidden transition-all duration-300 ease-in-out;
      }

      .collapsible-content-expanded {
        @apply max-h-[1000px];
      }

      .collapsible-icon {
        @apply transition-transform duration-300;
      }

      .collapsible-icon-expanded {
        @apply rotate-180;
      }

      /* Software download area style adjustment */
      .download-icon {
        @apply text-6xl text-gray-600; /* Increase icon size */
      }

      .download-title {
        @apply text-lg font-semibold text-gray-800 mb-1; /* Decrease title font */
      }

      .download-desc {
        @apply text-sm text-gray-600 mb-3; /* Decrease description font */
      }

      .download-button {
        @apply bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-all duration-300 flex items-center justify-center mx-auto text-sm; /* Decrease button size and font */
      }

      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7);
      }

      .modal-content {
        background-color: #fefefe;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 1200px;
        position: relative;
      }

      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }

      .close:hover,
      .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
      }

      /* Download confirmation popup styles */
      .download-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }

      .download-modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 300px;
        text-align: center;
        border-radius: 10px;
      }

      .download-modal-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
      }

      /* Compact mode styles */
      .compact-section {
        @apply mt-2;
      }

      .compact-card {
        @apply p-4 shadow-none;
      }

      .compact-icon {
        @apply text-4xl;
      }

      .compact-title {
        @apply text-lg font-bold; /* Increase text size */
      }

      .compact-desc {
        @apply text-xs mb-2;
      }

      .compact-button {
        @apply px-4 py-2 text-sm bg-primary hover:bg-primary/90 text-white rounded-lg transition-all duration-300; /* Increase button size */
      }

      /* Download card styles */
      .download-card {
        @apply p-4 shadow-md rounded-lg border border-gray-200 min-h-[180px]; /* Restore original padding, remove minimum height */
      }

      /* Update log area styles */
      .update-log h3 {
        @apply text-xl font-bold;
      }
    }
  </style>
</head>

<!-- Top navigation bar -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row md:items-center md:justify-between gap-2">
      <div class="flex items-center min-w-0">
        <i class="fas fa-video text-primary text-3xl mr-3"></i>
        <h1 class="header-title truncate">NiYien A1 Video Tutorial</h1>
      </div>
      <div class="flex flex-nowrap items-center justify-end min-w-0 gap-2 overflow-x-auto">
        <!-- Adjust button order, place the first use button on the left -->
        <button id="firstUseBtn" class="flex-shrink-0 bg-secondary hover:bg-secondary/90 text-white text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 rounded-lg transition-all duration-300 flex items-center">
          <i class="fa fa-rocket mr-1 sm:mr-2"></i> First Use
        </button>
        <!-- Move the first use mode label to the left of the text tutorial button -->
        <span id="firstUseBadge" class="flex-shrink-0 hidden first-use-badge text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 rounded-lg transition-all duration-300 flex items-center">First Use</span>
        <button id="textTutorialBtn" class="flex-shrink-0 bg-accent hover:bg-accent/90 text-white text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 rounded-lg transition-all duration-300 flex items-center">
          <i class="fa fa-book mr-1 sm:mr-2"></i> Text
        </button>
        <button id="showAllBtn" class="flex-shrink-0 bg-primary hover:bg-primary/90 text-white text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 rounded-lg transition-all duration-300 flex items-center hidden">
          <i class="fa fa-th-large mr-1 sm:mr-2"></i> Show All
        </button>
        <!-- Add language switch button -->

        <a id="chineseManualLink" href="#" class="flex-shrink-0 bg-gray-800 hover:bg-gray-700 text-white text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2  rounded-lg transition-all duration-300 flex items-center">
          <i class="fa fa-language mr-1 sm:mr-2"></i> Chinese
        </a>
      </div>
    </div>
  </header>

  <!-- Software download and update log area -->
  <section class="bg-white border-b border-gray-100 mt-4 compact-section">
    <div class="container mx-auto px-4">
      <div id="softwareDownloadHeader" class="collapsible-header">
        <div class="flex items-center">
          <i class="fa fa-download text-primary text-xl mr-3"></i>
          <h2 class="text-xl font-bold text-gray-800">Software Download and Update Log</h2>
        </div>
        <i id="softwareDownloadIcon" class="fa fa-chevron-down text-gray-500 collapsible-icon"></i>
      </div>
      <div id="softwareDownloadContent" class="collapsible-content">
        <div class="py-4 flex justify-center">
          <!-- Add vertical center alignment to the main container -->
          <div class="flex flex-col md:flex-row gap-8 w-full max-w-5xl items-center">
            <!-- Software download section - Widen the download bar -->
            <div class="w-full">
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <!-- Mac software download -->
                <div class="download-card flex flex-col items-center h-full p-4">
                  <div class="flex items-center mb-3 justify-center w-full">
                    <i class="fab fa-apple text-gray-600 text-4xl mr-3"></i>
                    <h3 class="text-lg font-semibold text-gray-800 whitespace-nowrap">NiYien A1 for Mac</h3>
                  </div>
                  <p class="version-text text-sm text-gray-500 text-center w-full"></p>
                  <p class="download-desc compact-desc text-center w-full">Supports macOS 11 and above.</p>
                  <button class="download-button compact-button w-full md:w-auto" onclick="window.open(config.urls.downloadMac, '_blank')">
                    <i class="fa fa-download mr-2"></i> Download
                  </button>
                </div>

                <!-- Windows software download -->
                <div class="download-card flex flex-col items-center h-full p-4">
                  <div class="flex items-center mb-3 justify-center w-full">
                    <i class="fab fa-windows text-gray-600 text-4xl mr-3"></i>
                    <h3 class="text-lg font-semibold text-gray-800 whitespace-nowrap">NiYien A1 for Win</h3>
                  </div>
                  <p class="version-text text-sm text-gray-500 text-center w-full"></p>
                  <p class="download-desc compact-desc text-center w-full">Supports Win10 and above</p>
                  <button class="download-button compact-button w-full md:w-auto" onclick="window.open(config.urls.downloadWindows, '_blank')">
                    <i class="fa fa-download mr-2"></i> Download
                  </button>
                </div>

                <!-- Gyroflow download -->
                <div class="download-card flex flex-col items-center h-full p-4">
                  <div class="flex items-center mb-3 justify-center w-full">
					<img src="assets/icon/gyroflow.svg" class="w-12 h-12 transform scale-[1.1] mr-3" alt="Gyroflow Icon">
					<h3 class="text-lg font-semibold text-gray-800 whitespace-nowrap">Gyroflow</h3>
				  </div>
				  <p class="text-sm text-gray-500 text-center w-full">Nightly build</p>
				  <p class="download-desc compact-desc text-center w-full">Supports macOS Win Linux</p>
                  <a href="https://gyroflow.xyz/devbuild" target="_blank" class="download-button compact-button w-full md:w-auto">
                    <i class="fa fa-download mr-2"></i> Download
                  </a>
                </div>
				
                 <div class="download-card flex flex-col items-center h-full p-4">
                  <div class="flex items-center mb-3 justify-center w-full">
                    <i class="fa fa-history text-gray-600 text-4xl mr-3"></i>
                    <h3 class="text-lg font-semibold text-gray-800 whitespace-nowrap">Update Log</h3>
                  </div>
                  <div class="space-y-2 text-xs">
                    <button class="download-button compact-button w-full" onclick="window.open(config.urls.firmwareChangelog, '_blank')">
                    <i class="fa fa-microchip mr-2"></i> A1 Firmware
                    </button>
                    <button class="download-button compact-button w-full" onclick="window.open(config.urls.softwareChangelog, '_blank')">
                    <i class="fa fa-wrench mr-2"></i> Niyien tool
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    // Centralized management of all URLs and image paths for easy modification
    const config = {
      urls: {
        textTutorial: "NiYien_txt_manual_EN.html",
        firmwareChangelog: "https://www.niyien.com/update_A1_en.html",
        softwareChangelog: "https://www.niyien.com/update_Niyien_tool_en.html",
        downloadMac: "https://drive.google.com/drive/folders/14lVHH6HA2oLJyfxAodWUDE8_jFBOleJf?usp=sharing",
        downloadWindows: "https://drive.google.com/drive/folders/1JcgBvcy9HCDQzrZVCUgb1-XcJmI7s8ma?usp=sharing",
        chineseManual: "NiYien_manual_ZH.html" // Add Chinese manual URL
      },
      images: {
        wechatQrCode: "assets/qrcode/VX.png"
      }
    };

    // Video data
    const videoData = [
      {
        id: "1.1",
        title: "Overview",
        description: "Understand the functions and features of the product",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/d498qb6vyDA" title="Senseflow Overview" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "software",
        showConditions: ""
      },
      {
        id: "1.2",
        title: "Software Download and Installation",
        description: "Understanding Software Download and Installation",
        date: "2025-07-20",
        embedCode: '<iframe width="914" height="514" src="https://www.youtube.com/embed/FXAYYG8fwQE" title="Software downloadand installation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: true,
        category: "software",
        showConditions: ""
      },
      {
        id: "2.1",
        title: "Gyroscope Button Operations",
        description: "Gyroscope Button Operations and Functions",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/R1Frha_7ZQk" title="Button operation" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: true,
        category: "gyroscope",
        showConditions: ""
      },
      {
        id: "2.2",
        title: "Firmware Upgrade, Time Setting, Memory Card Formatting, Gyro Calibration",
        description: "Understand the various settings of the gyroscope",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/imtuj5tl_IQ" title="Firmware Upgrade;Time Set;Format Memory Card;Gyro Calibration" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "gyroscope",
        showConditions: ""
      },
      {
        id: "3.1",
        title: "Auto Mode",
        description: "Master the use of the auto mode",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/T9nvaFUpgHs" title="Senseflow A1 Usage(Auto mode)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: true,
        category: "tools",
        showConditions: ""
      },
      {
        id: "3.2",
        title: "Semi-auto and Manual Modes",
        description: "Master the use of the semi-auto and manual modes",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/Ixz4PqM8BZA" title="Semi-auto and manual mode" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: true,
        category: "tools",
        showConditions: ""
      },
      {
        id: "3.3",
        title: "Installation Direction, Horizon Lock, Sync Speed, Advanced Options",
        description: "Detailed of the functions and application scenarios of various output settings",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/dmz-ChUiyMk" title="Install Rotation; Lock Horizon; Sync Speed; Advanced" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "tools",
        showConditions: ""
      },
      {
        id: "4.1",
        title: "Video Editor Plugin",
        description: "Learn how to use the plugin in mainstream video editors",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/gxLKszfB7lQ" title="Usage of VideoEditor Plugins(Davinci, PR, AE)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "advanced",
        showConditions: "editor"
      },
      {
        id: "4.2",
        title: "Vertical Shooting",
        description: "Understand the stabilization of vertical shooting videos",
        date: "2025-07-20",
        embedCode: '',
        isRequired: false,
        category: "advanced",
        showConditions: ""
      },
      {
        id: "4.3",
        title: "Anamorphic lens",
        description: "Understand the stabilization of anamorphic lens",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/_IdHar2qh-I" title="Anamorphic lens" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "advanced",
        showConditions: ""
      },
      {
        id: "4.4",
        title: "Slow motion video",
        description: "Understand the stabilization of slow motion videos",
        date: "2025-07-20",
        embedCode: '<iframe width="853" height="480" src="https://www.youtube.com/embed/BCdWe9gS5U4" title="Slow motion video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        isRequired: false,
        category: "advanced",
        showConditions: ""
      }
    ];
  </script>

  <main class="flex-grow px-6 py-8">
    <!-- Tutorial section area -->
    <section id="tutorialsContainer" class="space-y-8">
      <!-- Video content will be dynamically rendered by JavaScript -->
    </section>
  </main>

  <footer class="bg-gray-800 text-white py-8 mt-12">
    <div class="container mx-auto px-4">
      <div class="flex justify-center">
        <a href="https://discord.gg/dyna2DtqEA" target="_blank" class="text-white hover:text-primary transition-colors duration-300 flex items-center space-x-2">
          <i class="fab fa-discord text-2xl"></i>
          <span>Join the Discord channel</span>
        </a>
      </div>
    </div>
  </footer>

  <!-- Modal -->
  <div id="videoModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="modalVideo" class="video-ratio"></div>
    </div>
  </div>

  <!-- Download confirmation popup -->
  <div id="downloadModal" class="download-modal">
    <div class="download-modal-content">
      <h3 class="text-lg font-bold mb-2">Confirm Download</h3>
      <p class="text-gray-600 mb-4">Are you sure you want to download the NiYien A1 software?</p>
      <div class="download-modal-buttons">
        <button id="downloadCancelBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition-all duration-300">
          Cancel
        </button>
        <button id="downloadConfirmBtn" class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-all duration-300">
          Confirm
        </button>
      </div>
    </div>
  </div>

  <script>
    // Collapsible panel interaction
    function setupCollapsible(headerId, contentId, iconId) {
      const header = document.getElementById(headerId);
      const content = document.getElementById(contentId);
      const icon = document.getElementById(iconId);

      header.addEventListener('click', () => {
        content.classList.toggle('collapsible-content-expanded');
        icon.classList.toggle('collapsible-icon-expanded');
      });
    }

    // Set up all collapsible panels
    // Initialize all collapsible panels
    setupCollapsible('softwareDownloadHeader', 'softwareDownloadContent', 'softwareDownloadIcon');

    // Fix the QR code image display issue
    document.addEventListener('DOMContentLoaded', function() {
      const chineseManualLink = document.getElementById('chineseManualLink');
      if (chineseManualLink) {
        chineseManualLink.href = config.urls.chineseManual;
      }

      // Add first use state caching logic
      let firstUseMode = localStorage.getItem('firstUseMode');

      // Enable first use mode by default
      if (firstUseMode === null) {
        firstUseMode = 'true';  // Set the default value to true
        localStorage.setItem('firstUseMode', firstUseMode);
      }

      // Display the corresponding mode based on the saved state
      if (firstUseMode === 'true') {
        // First use mode
        firstUseBadge.classList.remove('hidden');
        firstUseBtn.classList.add('hidden');
        showAllBtn.classList.remove('hidden');
        const filteredVideos = videoData.filter(video => video.isRequired);
        renderVideos(filteredVideos);
      } else {
        // Show all mode
        firstUseBadge.classList.add('hidden');
        showAllBtn.classList.add('hidden');
        firstUseBtn.classList.remove('hidden');
        renderVideos(videoData);
      }
      const qrCodeImg = document.getElementById('wechatQrCodeImg');
      if (qrCodeImg) {
        qrCodeImg.src = config.images.wechatQrCode;
        // Add error handling, display alternate text when the QR code fails to load
        qrCodeImg.onerror = function() {
          this.alt = 'WeChat group QR code (image failed to load)';
          this.style.backgroundColor = '#f0f0f0';
          this.style.display = 'flex';
          this.style.alignItems = 'center';
          this.style.justifyContent = 'center';
          this.innerHTML = '<i class="fa fa-qrcode text-5xl text-gray-400"></i>';
        };
      }

      // Dynamically load the version number
      fetch('Update/update.json')
       .then(response => {
          if (!response.ok) throw new Error('Network response was not ok');
          return response.json();
        })
       .then(data => {
          const version = data.NiYien_tool.version;
          // Update the version number display
          document.querySelectorAll('.version-text').forEach(el => {
            el.textContent = `Version: ${version}`;
          });
        })
       .catch(error => console.error('Error loading version:', error));
    });

    // Chapter collapse/expand function
    document.querySelectorAll('.section-title').forEach(title => {
      title.addEventListener('click', () => {
        const sectionId = title.getAttribute('data-section');
        const content = document.getElementById(sectionId);
        const icon = title.querySelector('i.fa-chevron-down');

        content.classList.toggle('hidden');
        icon.classList.toggle('rotate-180');
      });
    });

    // All chapters are expanded by default
    document.querySelectorAll('.section-title').forEach(title => {
      const icon = title.querySelector('i.fa-chevron-down');
      icon.classList.add('rotate-180');
    });

    // Render video cards
    function renderVideos(videos) {
      const container = document.getElementById('tutorialsContainer');
      container.innerHTML = '';

      // Group videos by category
      const categories = {};
      videos.forEach(video => {
        if (!categories[video.category]) {
          categories[video.category] = [];
        }
        categories[video.category].push(video);
      });

      // Render each category
      for (const category in categories) {
        const categoryVideos = categories[category];

        // Create a chapter container
        const section = document.createElement('div');
        section.className = 'bg-white rounded-xl shadow-sm overflow-hidden';

        // Create a chapter title
        const titleBar = document.createElement('div');
        titleBar.className = 'p-6 border-b border-gray-100 section-title';
        titleBar.setAttribute('data-section', category);

        // Set the icon and title text
        let iconClass = 'fa-laptop';
        let sectionTitle = '';

        switch (category) {
          case 'software':
            iconClass = 'fa-laptop';
            sectionTitle = '1. Software';
            break;
          case 'gyroscope':
            iconClass = 'fa-compass';
            sectionTitle = '2. Gyroscope Operations';
            break;
          case 'tools':
            iconClass = 'fa-wrench';
            sectionTitle = '3. NiYien Tool Operations';
            break;
          case 'advanced':
            iconClass = 'fa-rocket';
            sectionTitle = '4. Advanced Applications';
            break;
        }

        titleBar.innerHTML = `
          <i class="fa ${iconClass} text-primary mr-3"></i>
          <span>${sectionTitle}</span>
          <i class="fa fa-chevron-down ml-auto transition-transform duration-300"></i>
        `;

        // Create a video content container
        const content = document.createElement('div');
        content.className = 'p-6 space-y-6';
        content.id = category;

        // Create a video grid (responsive layout adjustment)
        const videoGrid = document.createElement('div');
        videoGrid.className = 'video-grid-container grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';

        // Add video cards
        categoryVideos.forEach(video => {
          const card = document.createElement('div');
          // Use the new video-card class to unify the width
          card.className = 'rounded-lg overflow-hidden shadow-sm card-hover video-card';
          card.setAttribute('data-id', video.id);
          if (video.showConditions) {
            card.setAttribute('data-show', video.showConditions);
          }

          // Check if the "Choose one of two" badge needs to be displayed
          let badgeHtml = '';
          if (video.isRequired) {
            const bothVisible = videos.some(v => v.id === "3.1" && v.isRequired) &&
              videos.some(v => v.id === "3.2" && v.isRequired);

            if (bothVisible && (video.id === "3.1" || video.id === "3.2")) {
              badgeHtml = '<span class="required-badge">Watch one of two</span>';
            } else {
              badgeHtml = '<span class="required-badge">Must Watch</span>';
            }
          }

          card.innerHTML = `
            <div class="relative video-ratio bg-gray-200">
              <img src="assets/tn/en/${video.id.replace('.', '_')}.jpg" alt="${video.title}" class="absolute inset-0 w-full h-full object-cover">
              <span class="absolute top-2 left-2 bg-primary text-white text-xs font-bold px-2 py-1 rounded">${video.id}</span>
            </div>
            <div class="p-4">
              <h3 class="font-semibold text-gray-800 mb-2">${video.title}</h3>
              <p class="text-gray-600 text-sm mb-3">${video.description}</p>
              <div class="flex justify-between items-center">
                <span class="text-gray-500 text-xs"><i class="fa fa-calendar mr-1"></i> ${video.date}</span>
                ${badgeHtml}
              </div>
            </div>
          `;

          // Add a click event to the video card
          card.addEventListener('click', () => {
            openVideoModal(video.embedCode);
          });

          videoGrid.appendChild(card);
        });

        content.appendChild(videoGrid);
        section.appendChild(titleBar);
        section.appendChild(content);
        container.appendChild(section);
      }

      // Bind chapter collapse events
      document.querySelectorAll('.section-title').forEach(title => {
        title.addEventListener('click', () => {
          const sectionId = title.getAttribute('data-section');
          const content = document.getElementById(sectionId);
          const icon = title.querySelector('i.fa-chevron-down');

          content.classList.toggle('hidden');
          icon.classList.toggle('rotate-180');
        });
      });
    }

    const firstUseBtn = document.getElementById('firstUseBtn');
    const showAllBtn = document.getElementById('showAllBtn');
    const firstUseBadge = document.getElementById('firstUseBadge');
    const textTutorialBtn = document.getElementById('textTutorialBtn');

    // Text tutorial button click event
    textTutorialBtn.addEventListener('click', () => {
      // Open the text tutorial page in a new window
      window.open(config.urls.textTutorial, '_blank');
    });

    // First use button click event
    firstUseBtn.addEventListener('click', () => {
      // Switch to first use mode
      firstUseBadge.classList.remove('hidden');
      firstUseBtn.classList.add('hidden');
      showAllBtn.classList.remove('hidden');

      // Filter and display necessary videos
      const filteredVideos = videoData.filter(video => video.isRequired);
      renderVideos(filteredVideos);

      // Update the cache state - Set to first use mode
      localStorage.setItem('firstUseMode', 'true');
    });

    // Show all button click event
    showAllBtn.addEventListener('click', () => {
      // Switch back to show all mode
      firstUseBadge.classList.add('hidden');
      showAllBtn.classList.add('hidden');
      firstUseBtn.classList.remove('hidden');

      // Show all videos
      renderVideos(videoData);

      // Update the cache state - Set to show all mode
      localStorage.setItem('firstUseMode', 'false');
    });

    // Open the video modal
    function openVideoModal(embedCode) {
      const modal = document.getElementById('videoModal');
      const modalVideo = document.getElementById('modalVideo');
      const closeBtn = document.getElementsByClassName('close')[0];

      // Set the video content
      modalVideo.innerHTML = embedCode;

      // Show the modal
      modal.style.display = 'block';

      // Close button event
      closeBtn.onclick = function() {
        modal.style.display = 'none';
        // Clear the video content to stop playing
        modalVideo.innerHTML = '';
      }

      // Click outside the modal to close
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
          // Clear the video content to stop playing
          modalVideo.innerHTML = '';
        }
      }
    }

    // Show the download confirmation popup
    function showDownloadModal(url) {
      const modal = document.getElementById('downloadModal');
      const confirmBtn = document.getElementById('downloadConfirmBtn');
      const cancelBtn = document.getElementById('downloadCancelBtn');

      // Show the modal
      modal.style.display = 'block';

      // Confirm the download
      confirmBtn.onclick = function() {
        modal.style.display = 'none';
        // Jump to the download link
        window.location.href = url;
      }

      // Cancel the download
      cancelBtn.onclick = function() {
        modal.style.display = 'none';
      }

      // Click outside the modal to close
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      }
    }

    // Initial rendering of all videos
    renderVideos(videoData);
  </script>
</body>

</html>